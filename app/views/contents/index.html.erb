<h3>投稿一覧</h3>

<% if user_signed_in? %>
<%= link_to "マイページへ", user_path(current_user.id) %>
<% end %>

<h3>投稿を検索</h3>
 <%= form_tag({controller:"contents",action:"search"}, method: :get) do %>
   <%= text_field_tag :search %>
   <%= submit_tag '検索する'  %>
<% end %>

<div class="contents-container">
    <% @contents.each do |c| %>
        <div class="contents">
            <%= c.title %>
            <%= c.artist %>
            <%= video_tag c.video ,:controls => true if c.video? %>
            <%= c.my_comment %>
            <a href="/users/<%= c.user.id %>">
                <%= c.user.name %>
            </a>
            <%= c.created_at %>
        </div>
        <%= link_to "詳細へ", content_path(c.id) %>
    <% if user_signed_in? %>
      <% if current_user.already_liked?(c) %>
          <%= link_to content_like_path(id: c.id, content_id: c.id), method: :delete do %>
              <p>いいねを取り消す</p><%= c.likes.count %>
          <% end %>
            <% else %>
             <%= link_to content_likes_path(id: c.id, content_id: c.id), method: :post do %>
                <p>いいね</p><%= c.likes.count %>
            <% end %>
            <% end %>
        <% else %>
            <p>いいねの数 = </p><%= c.likes.count %>
    <% end %>

    <% end %>
</div>



<%= link_to "新規投稿", new_content_path %>
<%= link_to "ログイン", new_user_session_path %>
<%= button_to "ログアウト", destroy_user_session_path, method: :delete %>
